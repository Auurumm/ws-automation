import json
import streamlit as st
from openai import OpenAI
from config import OPENAI_CONFIG, CONTENT_TYPES, QUALITY_CONFIG
import time

class AIAnalyzer:
    def __init__(self, api_key):
        self.client = OpenAI(api_key=api_key)
        self.config = OPENAI_CONFIG
    
    def generate_blog_content_bgn_style(self, selected_material, style, length, additional_request, bgn_style_params):
        """BGN í†¤ì•¤ë§¤ë„ˆë¡œ ë¸”ë¡œê·¸ ì½˜í…ì¸  ìƒì„±"""
        
        material = selected_material['data']
        material_type = selected_material['type']
        
        # BGN ìŠ¤íƒ€ì¼ ë§¤ê°œë³€ìˆ˜ ì¶”ì¶œ
        staff_role = bgn_style_params.get('staff_role', 'ê²€ì•ˆì‚¬')
        staff_name = bgn_style_params.get('staff_name', 'ê¹€ì„œì—°')
        use_emotions = bgn_style_params.get('use_emotions', True)
        use_casual_talk = bgn_style_params.get('use_casual_talk', True)
        use_empathy = bgn_style_params.get('use_empathy', True)
        
        # ëª©í‘œ ê¸€ììˆ˜ ì„¤ì •
        length_config = {
            "í‘œì¤€ í’ˆì§ˆ (2,000ì ì´ìƒ)": {"min_chars": 2000, "target_chars": 2200, "max_tokens": 3500},
            "ê³ í’ˆì§ˆ (2,500ì ì´ìƒ)": {"min_chars": 2500, "target_chars": 2700, "max_tokens": 4000},
            "í”„ë¦¬ë¯¸ì—„ (3,000ì ì´ìƒ)": {"min_chars": 3000, "target_chars": 3200, "max_tokens": 4500}
        }
        
        config = length_config.get(length, length_config["í‘œì¤€ í’ˆì§ˆ (2,000ì ì´ìƒ)"])
        
        # ì§ì ‘ ì¸ìš©êµ¬ ë° í‚¤ì›Œë“œ ì¶”ì¶œ
        direct_quote = material.get('direct_quote', '')
        keywords = material.get('keywords', [])
        
        prompt = f"""
BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì ) ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ BGN ê³ ìœ ì˜ í†¤ì•¤ë§¤ë„ˆë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. **ë°˜ë“œì‹œ {config['min_chars']}ì ì´ìƒ**ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

ğŸ“‹ ì†Œì¬ ì •ë³´:
- ìœ í˜•: {material_type}
- ì œëª©: {material['title']}
- ë‚´ìš©: {material['content']}
- í‚¤ì›Œë“œ: {', '.join(keywords[:8]) if keywords else 'ì—†ìŒ'}
- ì‹œê°„ëŒ€: {material['timestamp']}
- í™œìš© í¬ì¸íŠ¸: {material['usage_point']}
{f"- ì§ì ‘ ì¸ìš©: {direct_quote}" if direct_quote else ""}

ğŸ‘¤ BGN í™”ì ì„¤ì •:
- ì§ë¬´: {staff_role}
- ì´ë¦„: {staff_name}
- ìŠ¤íƒ€ì¼: {style}

ğŸ¯ BGN ê³ ìœ  í†¤ì•¤ë§¤ë„ˆ (ì ˆëŒ€ ì¤€ìˆ˜):
- **ì‹œì‘**: "ì•ˆë…•í•˜ì„¸ìš”, **BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )** {staff_role} **{staff_name}**ì…ë‹ˆë‹¤."
- **ì¢…ë£Œ**: "ì´ìƒìœ¼ë¡œ **BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )** {staff_role} **{staff_name}**ì´ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ë„ ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ëˆˆì„ ìƒê°í•˜ë©°..."

ğŸ—£ï¸ BGN ë§íˆ¬ íŠ¹ì§• (ìì—°ìŠ¤ëŸ½ê²Œ í˜¼ìš©):
- **ë‹¤ì–‘í•œ ì¢…ê²°ì–´ë¯¸**: í•´ìš”/ìŠµë‹ˆë‹¤/ì£ /ê±°ë“ ìš”/ë„¤ìš”/ë”ë¼ê³ ìš”/ë¼ê³ ìš”/ì´ì—ìš” ë“± ìì—°ìŠ¤ëŸ½ê²Œ ì„ì–´ì„œ ì‚¬ìš©
- **ê°ì • í‘œí˜„**: {':), ã… ã… , ..., ì›ƒìŒì´ ë‚˜ì™”ì–´ìš”, ìš¸ì»¥í–ˆìŠµë‹ˆë‹¤' if use_emotions else 'ì ˆì œëœ ê°ì • í‘œí˜„'}
- **êµ¬ì–´ì²´ í‘œí˜„**: {'ìì—°ìŠ¤ëŸ¬ìš´ ë§ì¤„ì„í‘œ, ê°íƒ„ì‚¬, ì›ƒìŒ í‘œí˜„ ì‚¬ìš©' if use_casual_talk else 'ì •ì¤‘í•œ êµ¬ì–´ì²´'}
- **ê³µê° í‘œí˜„**: {'ê´œì°®ìœ¼ì„¸ìš”, ì €í¬ê°€ ì˜†ì— ìˆì–ì•„ìš”, ì´í•´í•´ìš”' if use_empathy else 'ì „ë¬¸ì  ì¡°ì–¸'}

ğŸ’¡ BGN íŠ¹í™” í‘œí˜„ë²•:
- "ì˜¤ëŠ˜ë„ ì´ëŸ° ì¼ì´ ìˆì—ˆì–´ìš”" (ì¼ìƒ ì—í”¼ì†Œë“œ ì‹œì‘)
- "ê·¸ ë§ì— ì €ë„ ëª¨ë¥´ê²Œ..." (ìì—°ìŠ¤ëŸ¬ìš´ ê°ì • ë°˜ì‘)
- "ì‚¬ì‹¤ ì €í¬ë„ ë§ì´ ë°°ì›Œìš”" (ê²¸ì†í•œ ìì„¸)
- "ì´ê²Œ ë³„ê±° ì•„ë‹Œ ê²ƒ ê°™ì•„ë„ ì €ëŠ” ì¤‘ìš”í•˜ê²Œ ìƒê°í•´ìš”" (ì„¸ì‹¬í•œ ê´€ì‹¬)
- "ë¬´ë¦¬í•˜ê²Œ ê¶Œí•˜ì§€ëŠ” ì•Šì„ ê±°ì˜ˆìš”" (ê°•ìš” ì—†ëŠ” ì¡°ì–¸)
- "í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”" (ì¹œê·¼í•œ ì ‘ê·¼)

{f"ğŸ”§ ì¶”ê°€ ìš”ì²­ì‚¬í•­: {additional_request}" if additional_request else ""}

ğŸ“ BGN ë¸”ë¡œê·¸ êµ¬ì¡° (ê° ì„¹ì…˜ ì¶©ë¶„íˆ ê¸¸ê²Œ, ìµœì†Œ ê¸€ììˆ˜ ë³´ì¥):

# [í™˜ì ê²½í—˜ ì¤‘ì‹¬ì˜ ë”°ëœ»í•œ ì œëª©]

ì•ˆë…•í•˜ì„¸ìš”, **BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )** {staff_role} **{staff_name}**ì…ë‹ˆë‹¤.

## ì˜¤ëŠ˜ë„ ì´ëŸ° ì¼ì´ ìˆì—ˆì–´ìš”
(**ìµœì†Œ 5-6ë¬¸ë‹¨**, ì¼ìƒ ì—í”¼ì†Œë“œë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì‹œì‘)
- "ì•„ì¹¨ë¶€í„° í•œ ë¶„ì´ ë“¤ì–´ì˜¤ì‹œë”ë¼ê³ ìš”..."
- í™˜ìì˜ ì²«ì¸ìƒê³¼ ìƒí™© ë¬˜ì‚¬
- ìƒë‹´ ì´ˆê¸°ì˜ ë¶„ìœ„ê¸°ì™€ ëŒ€í™”
- {staff_role}ë¡œì„œì˜ ì²« ëŠë‚Œê³¼ ìƒê°
- í™˜ìì˜ êµ¬ì²´ì  ê³ ë¯¼ê³¼ ê±±ì •
- ì†Œì¬ ë‚´ìš©ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë…¹ì—¬ë‚´ê¸°

## ì‚¬ì‹¤ ì €í¬ë„ ë§ì´ ë°°ì›Œìš”
(**ìµœì†Œ 5-6ë¬¸ë‹¨**, ê²¸ì†í•˜ë©´ì„œë„ ì „ë¬¸ì ìœ¼ë¡œ)
- í™˜ìì—ê²Œì„œ ë°°ìš°ëŠ” ì ë“¤
- ì˜ë£Œì§„ì˜ ì†”ì§í•œ ì†Œê°ê³¼ ì„±ì°°
- êµ¬ì²´ì ì¸ ìƒë‹´/ì¹˜ë£Œ ê³¼ì • ì„¤ëª…
- "ì´ëŸ° ì¼€ì´ìŠ¤ëŠ” ì •ë§ ì¡°ì‹¬ìŠ¤ëŸ½ê±°ë“ ìš”"
- í™˜ìì™€ì˜ ì†Œí†µì—ì„œ ëŠë¼ëŠ” ì 
- BGNë§Œì˜ ì ‘ê·¼ ë°©ì‹ ì†Œê°œ

## ê·¸ë˜ì„œ ë” ì„¸ì‹¬í•˜ê²Œ ë´ë“œë ¸ì–´ìš”
(**ìµœì†Œ 5-6ë¬¸ë‹¨**, ê°œë³„ ë§ì¶¤ ì¼€ì–´ ê°•ì¡°)
- {material['usage_point']}ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ êµ¬ì²´ì  ì ‘ê·¼
- í™˜ìë³„ ë§ì¶¤ ìƒë‹´ ê³¼ì •
- "ë­”ê°€ ì´ìƒí•œ ê²Œ ìˆìœ¼ë©´ ì–¸ì œë“  ì—°ë½ì£¼ì‹œë¼ê³ ..."
- ì„¸ë¶€ì ì¸ ì„¤ëª…ê³¼ ì•ˆë‚´ ê³¼ì •
- í™˜ìì˜ ì§ˆë¬¸ê³¼ ì˜ë£Œì§„ì˜ ë‹µë³€
- ì‹¤ì œ ì¹˜ë£Œ/ê²€ì‚¬ ê²½í—˜ë‹´

## ë©°ì¹  í›„ì— ì—°ë½ì´ ì™”ì–´ìš”
(**ìµœì†Œ 4-5ë¬¸ë‹¨**, ê°ë™ì ì¸ í›„ê¸°)
- í™˜ìì˜ í”¼ë“œë°±ê³¼ ë³€í™”ëœ ëª¨ìŠµ
- êµ¬ì²´ì ì¸ ê°œì„  ì‚¬ë¡€ì™€ ë§Œì¡±ë„
- "ê·¸ ë§ì„ ë“£ëŠ” ìˆœê°„ ì €ë„ ëª¨ë¥´ê²Œ ìš¸ì»¥í–ˆìŠµë‹ˆë‹¤"
- ì¼ìƒìƒí™œì˜ êµ¬ì²´ì  ë³€í™”
- ì£¼ë³€ ì‚¬ëŒë“¤ì˜ ë°˜ì‘
- ì˜ë£Œì§„ìœ¼ë¡œì„œì˜ ë³´ëŒ

## ìƒê°í•´ë³´ë‹ˆ ë‹¹ì—°í•œ ì¼ì´ì—ˆì–´ìš”
(**ìµœì†Œ 4-5ë¬¸ë‹¨**, ê²¸ì†í•˜ê³  ë”°ëœ»í•˜ê²Œ)
- "ì €í¬ê°€ íŠ¹ë³„í•œ ê±¸ í•œ ê±´ ì•„ë‹ˆì—ìš”"
- í™˜ì ì¤‘ì‹¬ ì„œë¹„ìŠ¤ì˜ ë‹¹ì—°í•¨
- BGNì˜ ì¼ìƒì ì¸ ì¼€ì–´ ë¬¸í™”
- ì‘ì€ ë°°ë ¤ì˜ í° ì˜ë¯¸
- í™˜ìì™€ ì˜ë£Œì§„ì˜ ìƒí˜¸ ì„±ì¥
- ì˜ë£Œì§„ì˜ ì‚¬ëª…ê°ê³¼ ë³´ëŒ

## ë¹„ìŠ·í•œ ê³ ë¯¼ì„ í•˜ê³  ê³„ì‹ ë‹¤ë©´
(**ìµœì†Œ 4-5ë¬¸ë‹¨**, ê°•ìš” ì—†ëŠ” ë”°ëœ»í•œ ì¡°ì–¸)
- "ì´ê²Œ ë³„ê±° ì•„ë‹Œ ê²ƒ ê°™ì•„ë„ ì €ëŠ” ì¤‘ìš”í•˜ê²Œ ìƒê°í•´ìš”"
- "ë¬´ë¦¬í•˜ê²Œ ê¶Œí•˜ì§€ëŠ” ì•Šì„ ê±°ì˜ˆìš”"
- "í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”" ë¶„ìœ„ê¸° ì¡°ì„±
- ì‘ì€ ê¶ê¸ˆì¦ë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì˜ ì¤‘ìš”ì„±
- BGNì˜ ì—´ë¦° ìƒë‹´ ë¬¸í™”
- í™˜ì ìŠ¤ìŠ¤ë¡œì˜ ì„ íƒì„ ì¡´ì¤‘í•˜ëŠ” ìì„¸

## ë§ˆì§€ë§‰ìœ¼ë¡œ í•˜ê³  ì‹¶ì€ ë§
(**ìµœì†Œ 3-4ë¬¸ë‹¨**, ì§„ì‹¬ ì–´ë¦° ë§ˆë¬´ë¦¬)
- í•µì‹¬ ë©”ì‹œì§€ ìš”ì•½
- í™˜ìì— ëŒ€í•œ ì§„ì†”í•œ ë§ˆìŒ
- "í˜¹ì‹œ ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”"
- BGN ì˜ë£Œì§„ì˜ ë‹¤ì§ê³¼ ì•½ì†
- ë…ìì—ê²Œ ì „í•˜ëŠ” ë”°ëœ»í•œ ë©”ì‹œì§€

ì´ìƒìœ¼ë¡œ **BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )** {staff_role} **{staff_name}**ì´ì—ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ë„ ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ëˆˆì„ ìƒê°í•˜ë©°... [ìì—°ìŠ¤ëŸ¬ìš´ ë§ˆë¬´ë¦¬ ì¸ì‚¬]

âš ï¸ BGN ì ˆëŒ€ ì¤€ìˆ˜ì‚¬í•­:
- **ë°˜ë“œì‹œ {config['min_chars']}ì ì´ìƒ ì‘ì„±** (ë¯¸ë‹¬ ì ˆëŒ€ ê¸ˆì§€)
- **ë‹¤ì–‘í•œ ì¢…ê²°ì–´ë¯¸ ìì—°ìŠ¤ëŸ½ê²Œ í˜¼ìš©** (í•´ìš”/ìŠµë‹ˆë‹¤/ì£ /ê±°ë“ ìš”/ë”ë¼ê³ ìš” ë“±)
- **BGN ê³ ìœ  í™”ì ì„¤ì • ìœ ì§€** ({staff_role} {staff_name}ì˜ 1ì¸ì¹­ ì‹œì )
- **ë³‘ì› í™ë³´ë‚˜ ì˜ì—…ì„± ë©˜íŠ¸ ì ˆëŒ€ ê¸ˆì§€** (ìì—°ìŠ¤ëŸ¬ìš´ ê²½í—˜ë‹´ ì¤‘ì‹¬)
- **ê°ì • í‘œí˜„ê³¼ êµ¬ì–´ì²´** ì ì ˆíˆ ì‚¬ìš© ({':), ã… ã… , ...' if use_emotions else 'ì ˆì œëœ í‘œí˜„'})
- **ê°•ìš” ì—†ëŠ” ë”°ëœ»í•œ ì¡°ì–¸** í†¤ ìœ ì§€
- **êµ¬ì²´ì  ì‚¬ë¡€ì™€ ê°œì¸ ê²½í—˜** í’ë¶€í•˜ê²Œ í¬í•¨
- **BGN ë¸Œëœë“œ ì •ì²´ì„±** (ë”°ëœ»í•¨, ì „ë¬¸ì„±, ì‹ ë¢°) ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„
- ê° ì„¹ì…˜ë³„ë¡œ **ì¶©ë¶„í•œ ë¶„ëŸ‰ í™•ë³´** (4-6ë¬¸ë‹¨ì”©)
- **ì¦‰ì‹œ ë°œí–‰ ê°€ëŠ¥í•œ ì™„ì„±í˜•** êµ¬ì¡°
"""

        max_attempts = 3
        for attempt in range(max_attempts):
            try:
                response = self.client.chat.completions.create(
                    model=self.config["model"],
                    messages=[
                        {
                            "role": "system", 
                            "content": f"""ë‹¹ì‹ ì€ BGNë°ì€ëˆˆì•ˆê³¼ ì „ì† ë¸”ë¡œê·¸ ì‘ê°€ì…ë‹ˆë‹¤. 

ğŸ¯ í•µì‹¬ ë¯¸ì…˜: 
- **ì ˆëŒ€ì ìœ¼ë¡œ {config['min_chars']}ì ì´ìƒì˜ BGN ë¸Œëœë“œ í†¤ì•¤ë§¤ë„ˆ ë¸”ë¡œê·¸ ì‘ì„±**
- BGN ê³ ìœ ì˜ ë”°ëœ»í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ 1ì¸ì¹­ ì‹¤ë¬´ì ì‹œì  êµ¬í˜„
- ì‹¤ì œ ì¸í„°ë·° ë‚´ìš©ì„ BGN ìŠ¤íƒ€ì¼ë¡œ ìƒìƒí•˜ê²Œ ì¬êµ¬ì„±
- ì¦‰ì‹œ ë°œí–‰ ê°€ëŠ¥í•œ ì™„ì„±ë„ ë†’ì€ ì½˜í…ì¸ 

ğŸ¥ BGN ë¸Œëœë“œ ì •ì²´ì„±:
- **ë”°ëœ»í•¨**: ê¸°ê³„ì ì´ì§€ ì•Šì€ ì¸ê°„ì  ì¼€ì–´
- **ì „ë¬¸ì„±**: ì˜í•™ì  ì •í™•ì„±ê³¼ ì‹ ë¢°ì„±
- **ì§„ì†”í•¨**: ê³¼ì¥ ì—†ëŠ” ì†”ì§í•˜ê³  ë‹´ë‹´í•œ ì†Œí†µ
- **ì ‘ê·¼ì„±**: ë¶€ë‹´ ì—†ì´ í¸í•˜ê²Œ ë‹¤ê°€ê°ˆ ìˆ˜ ìˆëŠ” ë¶„ìœ„ê¸°

ğŸ’¬ BGN í†¤ì•¤ë§¤ë„ˆ DNA:
1. **ìì—°ìŠ¤ëŸ¬ìš´ ë§íˆ¬**: ë‹¤ì–‘í•œ ì¢…ê²°ì–´ë¯¸ í˜¼ìš©ìœ¼ë¡œ ê¸°ê³„ì  ë°˜ë³µ ë°©ì§€
2. **ê²½í—˜ ê¸°ë°˜ ì„œì‚¬**: "ì˜¤ëŠ˜ ì´ëŸ° ì¼ì´ ìˆì—ˆì–´ìš”" ìŠ¤íƒ€ì¼ì˜ ì¼ìƒ ì—í”¼ì†Œë“œ
3. **ê²¸ì†í•œ ì „ë¬¸ì„±**: "ì €í¬ë„ ë§ì´ ë°°ì›Œìš”", "íŠ¹ë³„í•œ ê±´ ì•„ë‹ˆì—ìš”"
4. **ë‹´ë‹´í•œ ê³µê°**: ê³¼ì¥ ì—†ëŠ” ì§„ì†”í•œ ê°ì • í‘œí˜„
5. **ê°•ìš” ì—†ëŠ” ì¡°ì–¸**: "ë¬´ë¦¬í•˜ê²Œ ê¶Œí•˜ì§€ ì•Šì„ ê±°ì˜ˆìš”"
6. **ì—´ë¦° ì†Œí†µ**: "í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”", "ì‘ì€ ê²ƒë„ ì¢‹ìœ¼ë‹ˆê¹Œìš”"

âœï¸ BGN ê¸€ì“°ê¸° ì² í•™:
1. **ë¶„ëŸ‰ ì ˆëŒ€ ë³´ì¥**: ê° ë¬¸ë‹¨ 5-8ë¬¸ì¥ìœ¼ë¡œ í’ë¶€í•˜ê²Œ
2. **êµ¬ì²´ì„± ê·¹ëŒ€í™”**: ì¼ë°˜ë¡  ëŒ€ì‹  ê°œì¸ ê²½í—˜ê³¼ êµ¬ì²´ì  ì‚¬ë¡€
3. **ìì—°ìŠ¤ëŸ¬ìš´ ì™„ì„±ë„**: ìˆ˜ì • ì—†ì´ ë°”ë¡œ ë°œí–‰ ê°€ëŠ¥í•œ ìˆ˜ì¤€
4. **ë¸Œëœë“œ ì¼ê´€ì„±**: BGNì˜ ë”°ëœ»í•˜ê³  ì „ë¬¸ì ì¸ ì´ë¯¸ì§€ ìœ ì§€
5. **ë…ì ì¤‘ì‹¬**: í™˜ìì˜ ì‹œì„ ì—ì„œ ë¶ˆì•ˆ í•´ì†Œì™€ ìì—°ìŠ¤ëŸ¬ìš´ ì„ íƒ ìœ ë„

ğŸš« BGN ì ˆëŒ€ ê¸ˆì§€ì‚¬í•­:
- {config['min_chars']}ì ë¯¸ë§Œ ì‘ì„±
- ë‹¨ì¡°ë¡œìš´ ì¢…ê²°ì–´ë¯¸ ë°˜ë³µ (í•´ìš”ë§Œ ê³„ì† ì‚¬ìš© ë“±)
- í˜•ì‹ì ì´ê±°ë‚˜ êµ¬ì¡°ì ì¸ ì œëª©
- ê³¼ë„í•œ ì˜ì—…ì„± ë©˜íŠ¸ë‚˜ ë³‘ì› ë°©ë¬¸ ìœ ë„
- "ë³´í†µ", "ëŒ€ë¶€ë¶„" ê°™ì€ ëª¨í˜¸í•œ í‘œí˜„
- BGN ë¸Œëœë“œ ì •ì²´ì„±ì— ë§ì§€ ì•ŠëŠ” í†¤"""
                        },
                        {"role": "user", "content": prompt}
                    ],
                    temperature=0.7,
                    max_tokens=config['max_tokens']
                )
                
                blog_content = response.choices[0].message.content
                char_count = len(blog_content)
                
                # BGN ìŠ¤íƒ€ì¼ ê²€ì¦
                bgn_validation = self._validate_bgn_style(blog_content, config['min_chars'])
                
                if char_count >= config['min_chars']:
                    st.success(f"âœ… BGN ìŠ¤íƒ€ì¼ ë¸”ë¡œê·¸ ì™„ì„±! (ì´ {char_count:,}ì)")
                    
                    if bgn_validation["bgn_score"] >= 0.7:
                        st.info(f"ğŸ¯ BGN í†¤ì•¤ë§¤ë„ˆ: ìš°ìˆ˜ ({bgn_validation['bgn_score']:.1f}/1.0)")
                    else:
                        st.warning(f"ğŸ¯ BGN í†¤ì•¤ë§¤ë„ˆ: ê°œì„ í•„ìš” ({bgn_validation['bgn_score']:.1f}/1.0)")
                        st.write("ê°œì„ ì‚¬í•­:", bgn_validation['improvement_suggestions'])
                    
                    return blog_content
                else:
                    if attempt < max_attempts - 1:
                        shortage = config['min_chars'] - char_count
                        st.warning(f"âš ï¸ ê¸€ììˆ˜ ë¶€ì¡± ({char_count:,}ì/{config['min_chars']:,}ì) - BGN ìŠ¤íƒ€ì¼ë¡œ ì¬ìƒì„± ì¤‘... ({attempt+2}/{max_attempts})")
                        
                        # BGN ìŠ¤íƒ€ì¼ ê°•í™” ìš”ì²­
                        prompt += f"\n\n**ê¸´ê¸‰ BGN ìš”ì²­**: í˜„ì¬ {char_count}ìë¡œ {shortage}ìê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. BGN í†¤ì•¤ë§¤ë„ˆë¥¼ ìœ ì§€í•˜ë©´ì„œ ê° ì„¹ì…˜ì„ ë”ìš± ìƒì„¸í•˜ê³  í’ë¶€í•˜ê²Œ ì‘ì„±í•˜ì—¬ ë°˜ë“œì‹œ {config['min_chars']}ìë¥¼ ë„˜ê²¨ì£¼ì„¸ìš”. íŠ¹íˆ BGNë§Œì˜ ë”°ëœ»í•œ ì—í”¼ì†Œë“œì™€ êµ¬ì²´ì ì¸ ê²½í—˜ë‹´ì„ ë” ë§ì´ í¬í•¨í•´ì£¼ì„¸ìš”."
                    else:
                        st.error(f"âŒ {max_attempts}ë²ˆ ì‹œë„í–ˆì§€ë§Œ BGN ëª©í‘œ ê¸€ììˆ˜ ë‹¬ì„± ì‹¤íŒ¨ (í˜„ì¬ {char_count}ì)")
                        st.warning("ğŸ’¡ ìƒì„±ëœ ë‚´ìš©ì„ ì œê³µí•˜ë‹ˆ BGN ìŠ¤íƒ€ì¼ë¡œ ì¶”ê°€ í¸ì§‘í•´ì£¼ì„¸ìš”.")
                        return blog_content
                        
            except Exception as e:
                if attempt < max_attempts - 1:
                    st.warning(f"BGN ë¸”ë¡œê·¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ - ì¬ì‹œë„ ì¤‘... ({attempt+2}/{max_attempts}): {str(e)}")
                else:
                    st.error(f"BGN ë¸”ë¡œê·¸ ìƒì„± ì‹¤íŒ¨: {str(e)}")
                    raise e
        
        return blog_content
    
    def _validate_bgn_style(self, blog_content, min_chars):
        """BGN í†¤ì•¤ë§¤ë„ˆ ìŠ¤íƒ€ì¼ ê²€ì¦"""
        bgn_score = 0.5
        improvement_suggestions = []
        
        # BGN ë¸Œëœë“œ ìš”ì†Œ ì²´í¬
        bgn_elements = {
            'has_bgn_intro': "BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )" in blog_content[:300],
            'has_bgn_outro': "BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì )" in blog_content[-300:],
            'has_staff_intro': any(role in blog_content[:200] for role in ['ê²€ì•ˆì‚¬', 'ê°„í˜¸ì‚¬', 'ì›ë¬´íŒ€', 'ì˜ë£Œì§„']),
            'has_daily_episode': "ì˜¤ëŠ˜ë„ ì´ëŸ° ì¼ì´" in blog_content or "ì˜¤ëŠ˜" in blog_content[:500]
        }
        
        if sum(bgn_elements.values()) >= 3:
            bgn_score += 0.2
        else:
            improvement_suggestions.append("BGN ë¸Œëœë“œ ìš”ì†Œ ê°•í™” í•„ìš”")
        
        # í†¤ì•¤ë§¤ë„ˆ ë‹¤ì–‘ì„± ì²´í¬
        tone_variety = {
            'ending_variety': len([end for end in ['í•´ìš”', 'ìŠµë‹ˆë‹¤', 'ì£ ', 'ê±°ë“ ìš”', 'ë”ë¼ê³ ìš”', 'ë¼ê³ ìš”'] if end in blog_content]),
            'emotion_expressions': any(expr in blog_content for expr in [':)', 'ã… ã… ', '...', 'ì›ƒìŒì´', 'ìš¸ì»¥']),
            'empathy_words': any(word in blog_content for word in ['ê´œì°®', 'í•¨ê»˜', 'ì˜†ì— ìˆ', 'ì´í•´'])
        }
        
        if tone_variety['ending_variety'] >= 4:
            bgn_score += 0.15
        elif tone_variety['ending_variety'] >= 2:
            bgn_score += 0.1
        else:
            improvement_suggestions.append("ì¢…ê²°ì–´ë¯¸ ë‹¤ì–‘ì„± ë¶€ì¡±")
        
        if tone_variety['emotion_expressions']:
            bgn_score += 0.1
        else:
            improvement_suggestions.append("ê°ì • í‘œí˜„ ë¶€ì¡±")
        
        if tone_variety['empathy_words']:
            bgn_score += 0.05
        else:
            improvement_suggestions.append("ê³µê° í‘œí˜„ ë¶€ì¡±")
        
        # BGN íŠ¹í™” í‘œí˜„ ì²´í¬
        bgn_phrases = [
            "ì €í¬ë„ ë§ì´ ë°°ì›Œìš”", "ë³„ê±° ì•„ë‹Œ ê²ƒ ê°™ì•„ë„", "ë¬´ë¦¬í•˜ê²Œ ê¶Œí•˜ì§€", 
            "í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”", "íŠ¹ë³„í•œ ê±¸ í•œ ê±´ ì•„ë‹ˆì—ìš”"
        ]
        
        found_phrases = sum(1 for phrase in bgn_phrases if phrase in blog_content)
        if found_phrases >= 2:
            bgn_score += 0.1
        else:
            improvement_suggestions.append("BGN íŠ¹í™” í‘œí˜„ ë¶€ì¡±")
        
        return {
            "bgn_score": min(bgn_score, 1.0),
            "improvement_suggestions": improvement_suggestions if improvement_suggestions else ["BGN í†¤ì•¤ë§¤ë„ˆê°€ ì˜ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤"],
            "bgn_elements": bgn_elements,
            "tone_variety": tone_variety
        }

    def analyze_interview_content_keyword_based(self, content):
        """í‚¤ì›Œë“œ ê¸°ë°˜ ì¸í„°ë·° ë¶„ì„ (BGN ë¸Œëœë“œ ê´€ì )"""
        content_length = len(content)
        
        if content_length <= 15000:
            st.info(f"ğŸ“„ í…ìŠ¤íŠ¸ ê¸¸ì´: {content_length:,}ì - BGN ë§ì¶¤ í‚¤ì›Œë“œ ë¶„ì„")
            return self._analyze_keywords_for_bgn(content)
        else:
            st.warning(f"ğŸ“„ í…ìŠ¤íŠ¸ ê¸¸ì´: {content_length:,}ì - ì²­í¬ ë‹¨ìœ„ BGN ë¶„ì„")
            return self._analyze_keywords_with_chunks_bgn(content)
    
    def _analyze_keywords_for_bgn(self, content):
        """BGN ë¸Œëœë“œ ê´€ì ì—ì„œ í‚¤ì›Œë“œ ë¶„ì„"""
        
        prompt = f"""
BGNë°ì€ëˆˆì•ˆê³¼(ì ì‹¤ì ) ì§ì› ì¸í„°ë·°ì—ì„œ BGN ë¸Œëœë“œì— ë§ëŠ” ë¸”ë¡œê·¸ ì†Œì¬ë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.

ğŸ“‹ ì¸í„°ë·° ë‚´ìš©:
{content}

ğŸ¥ BGN ë¸Œëœë“œ ê´€ì ì—ì„œ ì¶”ì¶œ:
1. **BGN íŠ¹í™” í‚¤ì›Œë“œ** - BGNì˜ ë”°ëœ»í•˜ê³  ì „ë¬¸ì ì¸ ë¸Œëœë“œì™€ ì—°ê²°ë˜ëŠ” í‚¤ì›Œë“œ
2. **ë‹¤ì–‘í•œ í†¤ì•¤ë§¤ë„ˆ ì†Œì¬** - ê²€ì•ˆì‚¬, ê°„í˜¸ì‚¬, ì›ë¬´íŒ€ ë“± ë‹¤ì–‘í•œ ì§ë¬´ ê´€ì ì˜ ì†Œì¬
3. **í™˜ì ì¤‘ì‹¬ ì—í”¼ì†Œë“œ** - BGNì˜ í™˜ì ì¼€ì–´ ì² í•™ì´ ë“œëŸ¬ë‚˜ëŠ” ì‹¤ì œ ì‚¬ë¡€

ğŸ“ ê²°ê³¼ í˜•ì‹:
{{
  "í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬": [
    {{
      "title": "BGN ì§ì› ì‹œì ì˜ êµ¬ì²´ì ì´ê³  ë”°ëœ»í•œ ë¸”ë¡œê·¸ ì œëª©",
      "content": "ì¸í„°ë·°ì—ì„œ ì‹¤ì œ ì–¸ê¸‰ëœ BGN ê´€ë ¨ êµ¬ì²´ì  ë‚´ìš©ê³¼ ì‚¬ë¡€ (ìµœì†Œ 120ì ì´ìƒ)",
      "keywords": ["BGN", "íŠ¹í™”", "í‚¤ì›Œë“œ", "6-8ê°œ"],
      "timestamp": "ì¸í„°ë·°ì—ì„œ ì–¸ê¸‰ëœ ì •í™•í•œ êµ¬ê°„",
      "usage_point": "BGN í†¤ì•¤ë§¤ë„ˆë¡œ 2000ì ì´ìƒ ë¸”ë¡œê·¸ êµ¬ì„± ë°©ì•ˆ",
      "staff_perspective": "ê²€ì•ˆì‚¬/ê°„í˜¸ì‚¬/ì›ë¬´íŒ€ ì¤‘ ì í•©í•œ í™”ì ì„¤ì •",
      "target_audience": "ì˜ˆë¹„ í™˜ì/ê¸°ì¡´ í™˜ì/ì¼ë°˜ì¸ ì¤‘ ì„ íƒ",
      "direct_quote": "BGN ì§ì›ì˜ ì¸ìƒì ì¸ ì§ì ‘ ì¸ìš©êµ¬ (ìˆë‹¤ë©´)",
      "bgn_brand_fit": "BGN ë¸Œëœë“œ ì •ì²´ì„±(ë”°ëœ»í•¨/ì „ë¬¸ì„±/ì‹ ë¢°)ê³¼ì˜ ì—°ê²°ì ",
      "emotion_tone": "í•´ë‹¹ ì†Œì¬ì˜ ê°ì •ì  í†¤ (ë”°ëœ»í•œ ê³µê°/ì „ë¬¸ì  ì‹ ë¢°/ìì—°ìŠ¤ëŸ¬ìš´ ì†Œí†µ ë“±)"
    }}
  ]
}}

âš ï¸ BGN ì¤‘ìš” ì§€ì¹¨:
- ë°˜ë“œì‹œ **6ê°œ ì´ìƒì˜ ì„œë¡œ ë‹¤ë¥¸ ì†Œì¬** ì œê³µ
- ê° ì†Œì¬ëŠ” **BGN ë¸Œëœë“œ ì •ì²´ì„±** (ë”°ëœ»í•¨, ì „ë¬¸ì„±, ì‹ ë¢°)ê³¼ ì—°ê²°
- **ë‹¤ì–‘í•œ ì§ë¬´ ê´€ì ** (ê²€ì•ˆì‚¬, ê°„í˜¸ì‚¬, ì›ë¬´íŒ€ ë“±) í¬í•¨
- ì¸í„°ë·°ì—ì„œ **ì‹¤ì œ ì–¸ê¸‰ëœ ë‚´ìš©**ë§Œ ì‚¬ìš©
- **êµ¬ì²´ì  ê°œì¸ íŠ¹ì„±**ê³¼ ê°ì • í¬í•¨ (ë‚˜ì´, ì§ì—…, ì¦ìƒ ë“±)
- BGNì˜ **ìì—°ìŠ¤ëŸ¬ìš´ í†¤ì•¤ë§¤ë„ˆ**ë¡œ í™•ì¥ ê°€ëŠ¥í•œ ì†Œì¬
- **2000ì ì´ìƒ ë¸”ë¡œê·¸ë¡œ í™•ì¥ ê°€ëŠ¥**í•œ êµ¬ì²´ì„± ë³´ì¥
- ê° ì†Œì¬ë§ˆë‹¤ **ì„œë¡œ ë‹¤ë¥¸ ê´€ì ê³¼ ì£¼ì œ** ì»¤ë²„
- BGN **ë¸Œëœë“œ ì°¨ë³„í™”** ìš”ì†Œ í¬í•¨

ì ˆëŒ€ ê¸ˆì§€:
- ì¼ë°˜ì ì´ê±°ë‚˜ ì¶”ìƒì ì¸ ë‚´ìš©
- "ë³´í†µ", "ëŒ€ë¶€ë¶„", "í”íˆ" ê°™ì€ ëª¨í˜¸í•œ í‘œí˜„
- ì¸í„°ë·°ì— ì—†ëŠ” ë‚´ìš© ì¶”ê°€
- BGN ë¸Œëœë“œì™€ ë§ì§€ ì•ŠëŠ” í†¤
"""

        try:
            response = self.client.chat.completions.create(
                model=self.config["model"],
                messages=[
                    {
                        "role": "system", 
                        "content": """ë‹¹ì‹ ì€ BGNë°ì€ëˆˆì•ˆê³¼ ì „ë¬¸ ì½˜í…ì¸  ê¸°íšìì…ë‹ˆë‹¤.

í•µì‹¬ ë¯¸ì…˜: 
- ì¸í„°ë·°ì—ì„œ BGN ë¸Œëœë“œì— ë§ëŠ” 2000ì ì´ìƒ ì™„ì„±ë„ ë†’ì€ ë¸”ë¡œê·¸ë¡œ í™•ì¥ ê°€ëŠ¥í•œ ì†Œì¬ ë°œêµ´
- BGNì˜ ë”°ëœ»í•˜ê³  ì „ë¬¸ì ì¸ ë¸Œëœë“œ ì •ì²´ì„±ì— ë§ëŠ” êµ¬ì²´ì ì´ê³  ìƒìƒí•œ ê°œì¸ ê²½í—˜ë‹´ ì¤‘ì‹¬
- ë‹¤ì–‘í•œ BGN ì§ë¬´ ê´€ì (ê²€ì•ˆì‚¬, ê°„í˜¸ì‚¬, ì›ë¬´íŒ€ ë“±)ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì†Œì¬

BGN ë¸Œëœë“œ ì¶”ì¶œ ì›ì¹™:
1. ì‹¤ì œ ì–¸ê¸‰ëœ êµ¬ì²´ì  ì‚¬ë¡€ë§Œ ì‚¬ìš©
2. BGNì˜ ë”°ëœ»í•¨, ì „ë¬¸ì„±, ì‹ ë¢°ì„±ì´ ë“œëŸ¬ë‚˜ëŠ” ë‚´ìš©
3. ê°œì¸ì  íŠ¹ì„±ê³¼ ê°ì • í¬í•¨
4. ë‹¤ì–‘í•œ ì—°ë ¹ëŒ€ì™€ ìƒí™© ì»¤ë²„
5. ê° ì†Œì¬ëŠ” ì„œë¡œ ë‹¤ë¥¸ ê´€ì ê³¼ ì£¼ì œ
6. BGN í†¤ì•¤ë§¤ë„ˆë¡œ 2000ì í™•ì¥ ê°€ëŠ¥ì„± ë³´ì¥

ì ˆëŒ€ ê¸ˆì§€:
- ì¼ë°˜ì ì´ê±°ë‚˜ ì¶”ìƒì ì¸ ë‚´ìš©
- "ì¼ë°˜ì ìœ¼ë¡œ", "ë³´í†µ", "ëŒ€ë¶€ë¶„" ê°™ì€ ëª¨í˜¸í•œ í‘œí˜„
- ì¸í„°ë·°ì— ì—†ëŠ” ë‚´ìš© ì¶”ê°€
- BGN ë¸Œëœë“œ ì •ì²´ì„±ì— ë§ì§€ ì•ŠëŠ” ì†Œì¬"""
                    },
                    {"role": "user", "content": prompt}
                ],
                temperature=0.3,
                max_tokens=4000
            )
            
            result = response.choices[0].message.content
            
            try:
                start = result.find('{')
                end = result.rfind('}') + 1
                if start != -1 and end > start:
                    json_str = result[start:end]
                    materials = json.loads(json_str)
                    
                    # BGN í’ˆì§ˆ ê²€ì¦
                    validated_materials = self._validate_bgn_keyword_materials(materials)
                    
                    st.success("âœ… BGN ë¸Œëœë“œ ë§ì¶¤ í‚¤ì›Œë“œ ë¶„ì„ ì™„ë£Œ!")
                    return validated_materials
                else:
                    raise json.JSONDecodeError("JSON í˜•ì‹ ì°¾ê¸° ì‹¤íŒ¨", result, 0)
                    
            except json.JSONDecodeError:
                st.warning("BGN ë¶„ì„ ê²°ê³¼ íŒŒì‹± ì‹¤íŒ¨ - BGN ìƒ˜í”Œ ë°ì´í„°ë¡œ ëŒ€ì²´")
                return self._get_bgn_keyword_fallback_materials()
                
        except Exception as e:
            st.error(f"BGN í‚¤ì›Œë“œ ë¶„ì„ ì‹¤íŒ¨: {str(e)}")
            raise e
    
    def _validate_bgn_keyword_materials(self, materials):
        """BGN í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬ í’ˆì§ˆ ê²€ì¦"""
        validated = {"í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬": []}
        
        if "í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬" in materials:
            for material in materials["í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬"]:
                # BGN í•„ìˆ˜ í•„ë“œ í™•ì¸
                required_fields = ["title", "content", "keywords", "usage_point", "staff_perspective", "bgn_brand_fit"]
                if all(key in material for key in required_fields):
                    # BGN ë¸Œëœë“œ ì í•©ì„± ì²´í¬
                    if len(material["content"]) >= 100:  # BGN ìµœì†Œ ë‚´ìš© ê¸¸ì´
                        if len(material.get("keywords", [])) >= 4:  # BGN í‚¤ì›Œë“œ ìˆ˜
                            # BGN ë¸Œëœë“œ ìš”ì†Œ í™•ì¸
                            bgn_elements = ["BGN", "ë”°ëœ»", "ì „ë¬¸", "ì‹ ë¢°", "ì¼€ì–´", "ì†Œí†µ"]
                            if any(element in material.get("bgn_brand_fit", "") for element in bgn_elements):
                                validated["í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬"].append(material)
        
        # BGN ìµœì†Œ ì†Œì¬ ìˆ˜ ë³´ì¥
        if len(validated["í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬"]) < 4:
            st.warning("âš ï¸ BGN ë¸Œëœë“œ ì í•© ì†Œì¬ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. BGN ìƒ˜í”Œ ì†Œì¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.")
            validated = self._get_bgn_keyword_fallback_materials()
        
        return validated
    
    def _get_bgn_keyword_fallback_materials(self):
        """BGN ë¸Œëœë“œ í‚¤ì›Œë“œ ê¸°ë°˜ í´ë°± ì†Œì¬"""
        return {
            "í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬": [
                {
                    "title": "BGN ê²€ì•ˆì‚¬ê°€ ê²½í—˜í•œ 20ëŒ€ ì§ì¥ì¸ì˜ ë¼ì‹ ê²°ì‹¬ê¸° - ë§ˆìŠ¤í¬ ì‹œëŒ€ì˜ ìƒˆë¡œìš´ ì„ íƒ",
                    "content": "ë§¤ì¼ ì•„ì¹¨ ì•ˆê²½ì„ ì°¾ìœ¼ë©° í•˜ë£¨ë¥¼ ì‹œì‘í•˜ê³ , ë§ˆìŠ¤í¬ ì°©ìš©ìœ¼ë¡œ ë”ìš± ë¶ˆí¸í•´ì§„ ì¼ìƒì„ ê²¬ë””ë‹¤ BGNì„ ì°¾ì•„ì˜¨ ê¹€OO(27ì„¸, íšŒì‚¬ì›)ë‹˜ì˜ ì§„ì†”í•œ ì´ì•¼ê¸°ì…ë‹ˆë‹¤. íŠ¹íˆ ì¬íƒê·¼ë¬´ì™€ ë§ˆìŠ¤í¬ ì°©ìš©ì´ ì¼ìƒí™”ë˜ë©´ì„œ ì•ˆê²½ì˜ ë¶ˆí¸í•¨ì´ ë”ìš± ì»¤ì¡Œë‹¤ê³  í•˜ì‹œë”ë¼ê³ ìš”.",
                    "keywords": ["BGN", "20ëŒ€", "ì§ì¥ì¸", "ë¼ì‹", "ì•ˆê²½", "ë§ˆìŠ¤í¬", "ì¼ìƒ", "ë¶ˆí¸í•¨"],
                    "timestamp": "ì¸í„°ë·° ì´ˆë°˜ë¶€ 15-25ë¶„ êµ¬ê°„",
                    "usage_point": "BGN ê²€ì•ˆì‚¬ ì‹œì ì—ì„œ ë™ì¼í•œ ê³ ë¯¼ì„ ê°€ì§„ ì Šì€ ì§ì¥ì¸ë“¤ì˜ ê³µê°ëŒ€ í˜•ì„±, ë¼ì‹ ìˆ˜ìˆ  ê²°ì‹¬ ê³¼ì •ì˜ ì‹¬ë¦¬ì  ë³€í™”, BGNë§Œì˜ ì„¸ì‹¬í•œ ìƒë‹´ ê³¼ì •ìœ¼ë¡œ 2000ì ì´ìƒ í™•ì¥",
                    "staff_perspective": "ê²€ì•ˆì‚¬",
                    "target_audience": "ì˜ˆë¹„ í™˜ì",
                    "direct_quote": "ë§¤ì¼ ì•„ì¹¨ì— ì•ˆê²½ë¶€í„° ì°¾ì•„ì•¼ í•˜ëŠ” ê²Œ ì •ë§ ìŠ¤íŠ¸ë ˆìŠ¤ì˜€ì–´ìš”",
                    "bgn_brand_fit": "BGNì˜ í™˜ì ë§ì¶¤ ìƒë‹´ê³¼ ê³µê°ì  ì†Œí†µ, ì Šì€ ì¸µì— ëŒ€í•œ ì´í•´",
                    "emotion_tone": "ë”°ëœ»í•œ ê³µê°ê³¼ ì „ë¬¸ì  ì¡°ì–¸"
                },
                {
                    "title": "BGN ê°„í˜¸ì‚¬ê°€ ë³¸ 50ëŒ€ ì£¼ë¶€ì˜ ë°±ë‚´ì¥ ìˆ˜ìˆ  í›„ ë‹¬ë¼ì§„ ì¼ìƒ - ë‹¤ì‹œ ì°¾ì€ ì„ ëª…í•œ ì„¸ìƒ",
                    "content": "ìš”ë¦¬í•  ë•Œ ì–‘ë…í†µì„ êµ¬ë¶„í•˜ì§€ ëª»í•˜ê³ , TV ìë§‰ì´ íë ¤ ë³´ì´ë˜ ë°•OO(52ì„¸, ì£¼ë¶€)ë‹˜ì´ BGNì—ì„œ ë°±ë‚´ì¥ ìˆ˜ìˆ  í›„ 20ë…„ ì „ì²˜ëŸ¼ ì„ ëª…í•´ì§„ ì‹œì•¼ë¥¼ ë˜ì°¾ìœ¼ì‹  ê°ë™ì ì¸ íšŒë³µ ìŠ¤í† ë¦¬ì…ë‹ˆë‹¤. ìˆ˜ìˆ  ì „ ë¶ˆì•ˆê°ë¶€í„° ìˆ˜ìˆ  í›„ ë†€ë¼ìš´ ë³€í™”ê¹Œì§€ì˜ ì „ ê³¼ì •ì´ ìƒìƒí•˜ê²Œ ë‹´ê²¨ìˆìŠµë‹ˆë‹¤.",
                    "keywords": ["BGN", "50ëŒ€", "ì£¼ë¶€", "ë°±ë‚´ì¥", "ìˆ˜ìˆ í›„ê¸°", "íšŒë³µ", "ì¼ìƒë³€í™”", "ì‹œì•¼ê°œì„ "],
                    "timestamp": "ì¸í„°ë·° ì¤‘ë°˜ë¶€ 30-45ë¶„ êµ¬ê°„",
                    "usage_point": "BGN ê°„í˜¸ì‚¬ ê´€ì ì—ì„œ ì¤‘ì¥ë…„ì¸µ í™˜ìë“¤ì˜ ë°±ë‚´ì¥ ìˆ˜ìˆ  ë¶ˆì•ˆê° í•´ì†Œ, ìˆ˜ìˆ  ê³¼ì • ìƒì„¸ ì„¤ëª…, íšŒë³µê¸°ê°„ ì •ë³´, ì‚¶ì˜ ì§ˆ ê°œì„  ì‚¬ë¡€ë¡œ 2000ì ì´ìƒ í™•ì¥",
                    "staff_perspective": "ê°„í˜¸ì‚¬",
                    "target_audience": "ê¸°ì¡´ í™˜ì",
                    "direct_quote": "ìˆ˜ìˆ  í›„ ì²˜ìŒ ë°–ì— ë‚˜ê°”ì„ ë•Œ ë‚˜ë­‡ì í•˜ë‚˜í•˜ë‚˜ê°€ ë‹¤ ë³´ì—¬ì„œ ìš¸ì»¥í–ˆì–´ìš”",
                    "bgn_brand_fit": "BGNì˜ ì„¸ì‹¬í•œ ìˆ˜ìˆ  í›„ ì¼€ì–´ì™€ í™˜ì ì¤‘ì‹¬ ì„œë¹„ìŠ¤",
                    "emotion_tone": "ê°ë™ì ì´ê³  í¬ë§ì ì¸ ë¶„ìœ„ê¸°"
                },
                {
                    "title": "BGN ì›ë¬´íŒ€ì´ ë§¤ì¼ ë“£ëŠ” í™˜ìë“¤ì˜ ì§„ì§œ ì†ë§ˆìŒ - ë¶ˆì•ˆì—ì„œ ì•ˆì‹¬ìœ¼ë¡œ",
                    "content": "BGN ì›ë¬´íŒ€ì—ì„œ ê·¼ë¬´í•˜ë©° ë§¤ì¼ ë‹¤ì–‘í•œ í™˜ìë¶„ë“¤ì˜ ì²« ë°©ë¬¸ë¶€í„° ì¹˜ë£Œ ì™„ë£Œê¹Œì§€ì˜ ê³¼ì •ì„ ì§€ì¼œë³´ë©´ì„œ ëŠë¼ëŠ” íŠ¹ë³„í•œ ìˆœê°„ë“¤ì…ë‹ˆë‹¤. ì²˜ìŒ ì˜¤ì‹¤ ë•Œì˜ ê±±ì •ìŠ¤ëŸ¬ìš´ í‘œì •ì´ ì ì°¨ ë°ì•„ì§€ëŠ” ëª¨ìŠµì„ ë³´ëŠ” ê²ƒì´ ê°€ì¥ í° ë³´ëŒì´ë¼ê³  í•©ë‹ˆë‹¤.",
                    "keywords": ["BGN", "ì›ë¬´íŒ€", "í™˜ì", "ìƒë‹´", "ë¶ˆì•ˆê°", "ì‹ ë¢°", "ì„œë¹„ìŠ¤", "ì¼€ì–´"],
                    "timestamp": "ì¸í„°ë·° í›„ë°˜ë¶€ 50-60ë¶„ êµ¬ê°„",
                    "usage_point": "BGN ì›ë¬´íŒ€ ì‹œì ì—ì„œ í™˜ìë“¤ì˜ ì‹¬ë¦¬ì  ë³€í™” ê³¼ì •, BGNì˜ ì°¨ë³„í™”ëœ ì„œë¹„ìŠ¤ ë¬¸í™”, í™˜ì ì¤‘ì‹¬ ìš´ì˜ ì² í•™ìœ¼ë¡œ 2000ì ì´ìƒ í™•ì¥",
                    "staff_perspective": "ì›ë¬´íŒ€",
                    "target_audience": "ì¼ë°˜ì¸",
                    "direct_quote": "ì²˜ìŒì—ëŠ” ë§ì´ ê¸´ì¥í•˜ì…¨ëŠ”ë°, ìƒë‹´ í›„ì—ëŠ” í‘œì •ì´ ì™„ì „íˆ ë‹¬ë¼ì§€ì‹œë”ë¼ê³ ìš”",
                    "bgn_brand_fit": "BGNì˜ í™˜ì ì¤‘ì‹¬ ì„œë¹„ìŠ¤ì™€ ì‹ ë¢° êµ¬ì¶• ê³¼ì •",
                    "emotion_tone": "ìì—°ìŠ¤ëŸ¬ìš´ ì†Œí†µê³¼ ì‹ ë¢°ê°"
                },
                {
                    "title": "BGN ì‹ ì… ê²€ì•ˆì‚¬ì˜ ì²« ìˆ˜ìˆ ì‹¤ ê²½í—˜ - ê¸´ì¥ì—ì„œ ê°ë™ê¹Œì§€",
                    "content": "BGNì— ì…ì‚¬í•œ ì§€ 3ê°œì›” ëœ ì‹ ì… ê²€ì•ˆì‚¬ë¡œì„œ ì²˜ìŒ ìˆ˜ìˆ ì‹¤ì— ë“¤ì–´ê°„ ë‚ ì˜ ë–¨ë¦¼ê³¼ ì ì°¨ ì ì‘í•´ê°€ëŠ” ê³¼ì •, ê·¸ë¦¬ê³  í™˜ìë¶„ë“¤ë¡œë¶€í„° ë°›ëŠ” ê°ì‚¬ ì¸ì‚¬ì— ëŒ€í•œ ì†Œì¤‘í•œ ê²½í—˜ë‹´ì…ë‹ˆë‹¤. ì„ ë°°ë“¤ì˜ ì„¸ì‹¬í•œ ì§€ë„ì™€ BGNë§Œì˜ êµìœ¡ ì‹œìŠ¤í…œì´ ì¸ìƒì ì´ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.",
                    "keywords": ["BGN", "ì‹ ì…", "ê²€ì•ˆì‚¬", "ìˆ˜ìˆ ì‹¤", "ì„±ì¥", "êµìœ¡", "ë©˜í† ë§", "íŒ€ì›Œí¬"],
                    "timestamp": "ì¸í„°ë·° ì¤‘ë°˜ë¶€ 35-50ë¶„ êµ¬ê°„",
                    "usage_point": "BGN ì˜ë£Œì§„ì˜ ì¸ê°„ì ì¸ ë©´ëª¨ì™€ ì„±ì¥ ìŠ¤í† ë¦¬, BGNì˜ êµìœ¡ ì‹œìŠ¤í…œê³¼ íŒ€ì›Œí¬ ë¬¸í™”, í™˜ì ì¼€ì–´ì— ëŒ€í•œ ì‚¬ëª…ê°ìœ¼ë¡œ 2000ì ì´ìƒ í™•ì¥",
                    "staff_perspective": "ì‹ ì… ê²€ì•ˆì‚¬",
                    "target_audience": "ì¼ë°˜ì¸",
                    "direct_quote": "ì²« ìˆ˜ìˆ  ì°¸ê´€ ë•Œ í™˜ìë¶„ì´ ê³ ë§™ë‹¤ê³  í•˜ì‹œëŠ”ë° ì •ë§ ìš¸ì»¥í–ˆì–´ìš”",
                    "bgn_brand_fit": "BGNì˜ ì²´ê³„ì ì¸ êµìœ¡ê³¼ ë”°ëœ»í•œ ì¡°ì§ë¬¸í™”",
                    "emotion_tone": "ì„±ì¥ê³¼ ê°ë™ì˜ ìŠ¤í† ë¦¬"
                }
            ]
        }

    # ê¸°ì¡´ ë©”ì„œë“œë“¤ (í˜¸í™˜ì„± ìœ ì§€)
    def analyze_interview_content(self, content):
        """ê¸°ì¡´ ì¹´í…Œê³ ë¦¬ ê¸°ë°˜ ë¶„ì„ (í˜¸í™˜ì„± ìœ ì§€)"""
        return self.analyze_interview_content_keyword_based(content)

def get_sample_materials():
    """BGN ë¸Œëœë“œ ìƒ˜í”Œ ì†Œì¬ ë°ì´í„° (ì—…ë°ì´íŠ¸)"""
    return {
        "í‚¤ì›Œë“œ ê¸°ë°˜ ì†Œì¬": [
            {
                "title": "BGN ê²€ì•ˆì‚¬ê°€ ë³¸ 20ëŒ€ ì§ì¥ì¸ì˜ ë¼ì‹ ì—¬ì • - ì•ˆê²½ì—ì„œ ììœ ë¡œì›Œì§€ê¸°ê¹Œì§€",
                "content": "ë§¤ì¼ ì•„ì¹¨ ì•ˆê²½ì„ ì°¾ëŠ” ê²ƒë¶€í„° ì‹œì‘ë˜ëŠ” ì¼ìƒ, ìš´ë™í•  ë•Œë§ˆë‹¤ í˜ëŸ¬ë‚´ë¦¬ëŠ” ì•ˆê²½, ë§ˆìŠ¤í¬ ì°©ìš© ì‹œ ì„œë¦¬ëŠ” ë¶ˆí¸í•¨ì„ ê²¬ë””ë‹¤ê°€ ë“œë””ì–´ ë¼ì‹ì„ ê²°ì‹¬í•œ ê¹€OO(27ì„¸, íšŒì‚¬ì›)ë‹˜ì˜ ì§„ì†”í•œ ì´ì•¼ê¸°ì…ë‹ˆë‹¤.",
                "keywords": ["BGN", "20ëŒ€", "ì§ì¥ì¸", "ë¼ì‹", "ì•ˆê²½", "ë¶ˆí¸í•¨", "ê²°ì‹¬", "ì¼ìƒ"],
                "timestamp": "ì¸í„°ë·° ì´ˆë°˜ë¶€ 10-15ë¶„ êµ¬ê°„",
                "usage_point": "BGN ê²€ì•ˆì‚¬ ì‹œì ì—ì„œ ë™ì¼í•œ ê³ ë¯¼ì„ ê°€ì§„ ì Šì€ ì§ì¥ì¸ë“¤ì˜ ê³µê°ëŒ€ í˜•ì„±",
                "staff_perspective": "ê²€ì•ˆì‚¬",
                "target_audience": "ì˜ˆë¹„ í™˜ì",
                "direct_quote": "ë§¤ì¼ ì•„ì¹¨ì— ì•ˆê²½ë¶€í„° ì°¾ì•„ì•¼ í•˜ëŠ” ê²Œ ì •ë§ ìŠ¤íŠ¸ë ˆìŠ¤ì˜€ì–´ìš”",
                "bgn_brand_fit": "BGNì˜ í™˜ì ë§ì¶¤ ìƒë‹´ê³¼ ê³µê°ì  ì†Œí†µ"
            },
            {
                "title": "BGN ê°„í˜¸ì‚¬ê°€ ê²½í—˜í•œ 50ëŒ€ ì£¼ë¶€ì˜ ë°±ë‚´ì¥ ìˆ˜ìˆ  ì„±ê³µê¸° - ìƒˆë¡œìš´ ì„¸ìƒì„ ë³´ë‹¤",
                "content": "ì¼ìƒìƒí™œì´ ë¶ˆí¸í•  ì •ë„ë¡œ ì‹œì•¼ê°€ íë ¤ì ¸ ë‚´ì›í•œ í™˜ìë¶„ì˜ ì¹˜ë£Œ ê³¼ì •ê³¼ íšŒë³µ í›„ê¸°ì…ë‹ˆë‹¤.",
                "keywords": ["BGN", "50ëŒ€", "ì£¼ë¶€", "ë°±ë‚´ì¥", "ìˆ˜ìˆ í›„ê¸°", "íšŒë³µ", "ì¼ìƒë³€í™”"],
                "timestamp": "ì¸í„°ë·° ì¤‘ë°˜ë¶€ 25-35ë¶„ êµ¬ê°„",
                "usage_point": "BGN ê°„í˜¸ì‚¬ ê´€ì ì—ì„œ ì¤‘ì¥ë…„ì¸µ í™˜ìë“¤ì˜ ì¹˜ë£Œ ê³¼ì •ê³¼ ë³€í™”",
                "staff_perspective": "ê°„í˜¸ì‚¬",
                "target_audience": "ê¸°ì¡´ í™˜ì"
            }
        ]
    }